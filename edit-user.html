<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="firebasestyle.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css"
    integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
</head>

<body>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12">
        <h2 class="text-center text-primary">Crud Application Firebase</h2>
        <hr class="pt-2 bg-primary w-25">
        <div class="row">
          <div class="col mb-3"><a href="firebasemy.html" class="btn btn-success">View All Users</a></div>
        </div>
      </div>
    </div>
    <div class="row align-items-center justify-content-center" style="height: 70vh;">
      <div class="col-sm-6  bg-light border p-5 rounded ">
        <h2 class="text-center mb-5">Edit User</h2>
        <form id="users-add">
          <div class="form-group">
            <input type="text" name="name" id="" class="form-control name" placeholder="Enter Name" required>
          </div>
          <div class="form-group">
            <input type="text" name="college" id="" class="form-control college" placeholder="Enter College" required>
          </div>
          <div class="form-group">
            <input type="submit" name="userdata" class="btn btn-block btn-primary">
          </div>
        </form>
      </div>
    </div>
  </div>


  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <!-- Popper JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-functions.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-database.js"></script>

  <script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
      apiKey: "AIzaSyC4RWbYmJCS-jEBY0zX3DXjxN1CDPQ3hU4",
      authDomain: "mywebapplication-d7e63.firebaseapp.com",
      databaseURL: "https://mywebapplication-d7e63.firebaseio.com",
      projectId: "mywebapplication-d7e63",
      storageBucket: "mywebapplication-d7e63.appspot.com",
      messagingSenderId: "327012128155",
      appId: "1:327012128155:web:b4e90f0af015939f5cbd3e",
      measurementId: "G-7G3YN1RTFL"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    var db = firebase.firestore();
    function getParameterByName(name, url = window.location.href) {
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    var id = getParameterByName('user-id');
    db.collection("users").doc(id).get().then((doc) => {
      if (doc.exists) {
        console.log("Document data:", doc.data());
        $('.name').val(doc.data().name);
        $('.college').val(doc.data().college);
      } else {
        // doc.data() will be undefined in this case
        console.log("No such document!");
      }
    });
    $(document).ready(function () {
      $('#users-add').on('submit', function (e) {
        e.preventDefault();
        let name = $('.name').val();
        let college = $('.college').val();
        db.collection("users").doc(id).set({
          name: name,
          college: college
        })
          .then(function () {
            console.log("Document successfully written!");
          })
          .catch(function (error) {
            console.error("Error writing document: ", error);
          });
      });

    })
  </script>
</body>

</html>